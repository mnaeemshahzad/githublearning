code from usa side
please test and verify
